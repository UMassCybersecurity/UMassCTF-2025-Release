order = ~(-1 << 512)
mask = 0b10110101001101101110100110111001000101000111000010011000100100101000110001000001011101110101111000110011100001110011100000010100101111001101010101111100110010111011000000111010001001100111000000000100100111100001100010000110011110010001011110101010001001111100010111010111110010111110101010010100111000000111011111001000100111000001010110111111001010111100011111111001000010101110000100100100101010101100010111011001110111100010010110010010111000001010101010000000110100010111011100010000111100010100111011011111


class Cipher:
    def __init__(self, mask, seed):
        print(f'mask={hex(mask)}')
        self.mask = mask
        self.seed = seed

    def next(self):
        self.seed = (self.seed << 1) | ((self.seed & self.mask).bit_count() & 1)
        self.seed &= order
        return self.seed % 5


flag = b'UMASS{REDACTED}'
flag = flag[5:]
print(f'len={len(flag)}')

current = int.from_bytes(flag)
c = Cipher(mask, current)
for _ in range(100):
    c.next()
flag_data = []
for _ in range(520):
    c.next()
    flag_data.append(c.next())
print(f'flag={flag_data}')